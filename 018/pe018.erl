-module(pe018).
-import(lists, [zipwith/3]).
-export([main/0]).

mins([H|T0]) ->
  T1 = lists:sublist([H|T0], length(T0)),
  zipwith(fun(A, B)->max(A, B) end, T1, T0).

merge([[N1]|Nss]) -> [N2] = merge(Nss), N1 + N2;
merge([[N1|Ns]]) -> mins([N1|Ns]);
merge([Ns|Nss]) -> mins(zipwith(fun(A, B) -> A + B end, Ns, merge(Nss))).

solve(Triangle) -> merge(Triangle).

main() ->
  Triangle = 
   [[75],
    [95,64],
    [17,47,82],
    [18,35,87,10],
    [20,04,82,47,65],
    [19,01,23,75,03,34],
    [88,02,77,73,07,63,67],
    [99,65,04,28,06,16,70,92],
    [41,41,26,56,83,40,80,70,33],
    [41,48,72,33,47,32,37,16,94,29],
    [53,71,44,65,25,43,91,52,97,51,14],
    [70,11,33,28,77,73,17,78,39,68,17,57],
    [91,71,52,38,17,14,91,43,58,50,27,29,48],
    [63,66,04,68,89,53,67,30,73,16,69,87,40,31],
    [04,62,98,27,23,09,70,98,73,93,38,53,60,04,23]],
  solve(Triangle).

% 12> pe018:main().      
% 1074
% 13> timer:tc(pe018, main, []).
% {18,1074}
